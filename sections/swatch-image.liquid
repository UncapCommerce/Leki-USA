{% assign color_list = product.metafields.custom.color.value %}
{% if color_list %}
  <style>  
    {% for color_item in color_list %}  
      {% assign color_name = color_item | split: '||' | first | remove: '["' %}
      {% assign color_code = color_item | split: '||' | last | remove: '"]' %}  
      .swatch__label__{{ color_name }}{
        background: {{ color_code }} !important;
      }
    {% endfor %}
  </style>
{% else %}
{% style %}  
  {% for block in section.blocks %}
    {% assign colorname = block.settings.heading | handleize %}
    {% unless colorname contains '.sw_label_' %}
      .swatch__label__{{ colorname | replace: '-sw_label_', '.sw_label_'  }}{
     {%  if block.settings.color_img != blank %}
          background-image: url({{ block.settings.color_img | img_url:'' }}) !important;
          background-repeat: no-repeat !important;
      {% else %}
        {% if block.settings.variant_bg_1 contains "linear-gradient" %}
          background:{{ block.settings.variant_bg_1 }} !important;
        {% else %}
          background-color:{{ block.settings.variant_bg_1 }} !important;
        {% endif %}  
      {% endif %}
      }
      {% endunless %}
  {% endfor %}

  {% for block in section.blocks %}
    {% assign colorname = block.settings.heading | handleize %}
    {% if colorname contains '.sw_label_' %}
      .swatch__label__{{ colorname | replace: '-sw_label_', '.sw_label_'  }}{
     {%  if block.settings.color_img != blank %}
          background-image: url({{ block.settings.color_img | img_url:'' }}) !important;
          background-repeat: no-repeat !important;
      {% else %}
        {% if block.settings.variant_bg_1 contains "linear-gradient" %}
          background:{{ block.settings.variant_bg_1 }} !important;
        {% else %}
          background-color:{{ block.settings.variant_bg_1 }} !important;
        {% endif %}  
      {% endif %}
      }
    {% endif %}
  {% endfor %}
{% endstyle %}
{% endif %}
{% schema %}
  {
    "name": "Swatch Image",
    "blocks":[
      {
        "name":"colorcode",
        "type":"colorcode",
        "settings":[
          {            
            "type": "image_picker",
            "id": "color_img",
            "label": "Color Image"            
          },
          {
            "type": "color_background",
            "id": "variant_bg_1",
            "label": "Background color"
          },
          {            
            "type": "text",
            "id": "heading",
            "label": "Heading"            
          }
        ]
      }
    ],
    "presets":[
      {
        "name":"Swatch Image"
      }
    ]
  }
{% endschema %}